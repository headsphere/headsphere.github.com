---
title: "Non-Uniform Random Variables"
author: "Nick Head"
date: "3 March 2015"
layout: default
---

#Generation of Non-Uniform Random Variables

```{r echo=FALSE}
library(knitr)
knitr::opts_chunk$set(fig.path='{{ site.url }}/images/non-uniform-rvs-')
```

##Inversion Method

For an RV $X$ with a pdf $f$ and cdf $F$ where:

$$F(x) = \int_{-\infty}^x f(t) dt$$

Assuming $F$ has an inverse, we can simulate $X$ by setting $U = F(X)$ via:

$$P(U \leq u) = P[F(X) \leq F(x)] = P[F^{-1}(F(X) \leq F^{-1}(F(x))] = P(X = x)$$

### Exponential Distribution

$$X \sim Exp(\lambda)$$

$$f(x) = \lambda e^{-\lambda x} \quad (x \geq 0)$$

$$F(x) = 1 - e^{-\lambda x} \quad (x \geq 0)$$

$$F^{-1}(u) = - \frac{log(1-u)}{\lambda} = - \frac{log(u)}{\lambda} = x$$

```{r}
n = 1000
lambda = 2
u = runif(n)
xInv = -log(u)/lambda
```
Compare with `rexp`:
```{r}
xExp = rexp(n, lambda)

par(mfcol = c(1,2))
hist(xInv)
hist(xExp)
```

### Logistic Distribution

$$X \sim \text{ Logistic}()$$

$$f(x) = \frac{e^{-x}}{(1 + e^{-x})^2}$$

$$F(x) = \frac{1}{(1 + e^{-x})}$$

$$F^{-1}(u) = - log(\frac{1}{u} - 1) = x$$

```{r}
n = 10000
u = runif(n)
xInv = -log(1/u - 1)
```
Compare with `rlogis`:
```{r}
xLogis = rlogis(n, 0, 1)

par(mfcol = c(1,2))
hist(xInv)
hist(xLogis)
```

##Table Lookup Method

###Binomial Distribution

$$X \sim Bin(10,0.3)$$

```{r}
n <- 10
p <- .3
t <- seq(0,n-1)
prob = pbinom(t,n,p)
```

With a CDF:
```{r echo=FALSE}
df = as.data.frame(round(t(prob),4))
colnames(df) = t
kable(df)
```

```{r}
Nsim=10^4; 
xTable=numeric(Nsim)
uvec = runif(Nsim)
xTable = as.numeric(lapply(uvec, function(u){ sum(prob<u)}))
```
Compare with `rbinom`:
```{r}
xBinom = rbinom(Nsim, n, p)
par(mfcol = c(1,2))
hist(xTable)
hist(xBinom)
```

###Poisson Distribution

$$X \sim Poisson(2)$$

```{r}
lambda=2
t=seq(0,9)
prob=ppois(t, lambda)
```

With a CDF:
```{r echo=FALSE}
df = as.data.frame(round(t(prob),4))
colnames(df) = t
kable(df)
```

```{r}
Nsim=10^4; 
xTable=numeric(Nsim)
uvec = runif(Nsim)
xTable = as.numeric(lapply(uvec, function(u){ sum(prob<u)}))

```
Compare with `rpois`:
```{r}
xPois = rpois(Nsim, lambda)
par(mfcol = c(1,2))
hist(xTable)
hist(xPois)
```


##Acceptance-Rejection Method

```{r}
M = optimize(f=function(x){dbeta(x,3,2)},interval=c(0,1),maximum=TRUE)$objective
M
```


```{r}
alpha <- 3
beta <- 2
ylim <- c(0, M)
xlim <- c(0, 1)
curve(dbeta(x,alpha,beta),from = 0,to = 1, xlim = xlim, ylim = ylim)
par(new=T)

Nsim = 1000
uvec = runif(Nsim, max=M)
yvec = runif(Nsim)
for(i in 1:Nsim){
  if(uvec[i] < dbeta(yvec[i], alpha, beta)){
    points(yvec[i], uvec[i], xlab = NA, ylab = NA, xaxt='n', yaxt='n', xlim = xlim, ylim = ylim, col="blue")
  }
  else{
    points(yvec[i], uvec[i], xlab = NA, ylab = NA, xaxt='n', yaxt='n', xlim = xlim, ylim = ylim, col="red")
  }
}
```